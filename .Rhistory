dend_list <- dendlist(dend, dend1) %>%
untangle(method = "step1side") %>% tanglegram(
highlight_distinct_edges = FALSE, # Turn-off dashed lines
common_subtrees_color_lines = FALSE, # Turn-off line colors
common_subtrees_color_branches = TRUE # Color common branches
)
dend_list <- dendlist(dend, dend1) %>%
untangle(method = "step1side") %>% tanglegram(dend, dend1)
dend_list <- dendlist(dend, dend1) %>% untangle(method = "step1side") %>% tanglegram(dend, dend1)
dend
dend
dend1
### Q4
#כאן צריך לכתוב על קווי דמיון ושוני בין שתי הדנדוגרמות
```{r}
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
dend_list <- dendlist(dend, dend1) %>% untangle(method = "step1side") %>% tanglegram()
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
g1
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
#g2
# highlight_distinct_edges = FALSE, # Turn-off dashed lines
# common_subtrees_color_lines = FALSE, # Turn-off line colors
# common_subtrees_color_branches = TRUE # Color common branches
# )
grid.arrange(g1, g2, ncol = 3, widths = c(2, 1, 2))
install.packages("gridExtra")
install.packages("gridExtra")
library(gridExtra)
library('MASS')
library(data.table)
library(ggplot2)
library(kableExtra)
library(dplyr)
library(dendextend)
library(readxl)
library(fuzzyjoin)
library(stringr)
library(ggdendro)
library(viridis)
library(factoextra)
library(FactoMineR)
library(gridExtra)
# highlight_distinct_edges = FALSE, # Turn-off dashed lines
# common_subtrees_color_lines = FALSE, # Turn-off line colors
# common_subtrees_color_branches = TRUE # Color common branches
# )
grid.arrange(g1, g2, ncol = 3, widths = c(2, 1, 2))
# highlight_distinct_edges = FALSE, # Turn-off dashed lines
# common_subtrees_color_lines = FALSE, # Turn-off line colors
# common_subtrees_color_branches = TRUE # Color common branches
# )
idx <- data.frame(y1 = 1:,label(dend1)
hcdata1 <- dendro_data(clus1,4)
hcdata1 <- dendro_data(clus1,4)
hcdata1 <- dendro_data(clus1)
hcdata1
hcdata2 <- dendro_data_k(clus, 5)
hcdata2 <- dendro_data_k(clus)
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
#g1
hcdata1 <- dendro_data(clus1)
hcdata2 <- dendro_data_k(clus)
hcdata2 <- dendro_data(clus)
hcdata2
idx <- data.frame(y1 = 1:nrow(hcdata1$labels),
y2 = match(hcdata1$labels$label, hcdata2$labels$label))
idx
p3 <- ggplot() +
geom_segment(data     = idx,
aes(x    = 0,
y    = y1,
xend = 1,
yend = y2),
color    = "grey") +
theme_void()
grid.arrange(g1, p3, g2, ncol = 3, widths = c(2, 1, 2))
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE,direction   = "lr")
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE,
direction   = "rl")
#g1
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE,direction   = "lr")
#g2
dend_list <- dendlist(dend, dend1) %>% untangle(method = "step1side") %>% tanglegram()
g2
g1
cols    <- c("#a9a9a9", "#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd")
p1 <- plot_ggdendro(hcdata1,
direction   = "lr",
scale.color = cols,
expand.y    = 0.2)
dend_list <- dendlist(dend, dend1) %>% untangle(method = "step1side") %>% tanglegram()
hcdata2
dend_list <- dendlist(hcdata1, hcdata2) %>% untangle(method = "step1side") %>% tanglegram()
library('MASS')
library(data.table)
library(ggplot2)
library(kableExtra)
library(dplyr)
library(dendextend)
library(readxl)
library(fuzzyjoin)
library(stringr)
library(ggdendro)
library(viridis)
#load the data frames
CBS_df <- read.delim("C:/Users/Shahar/Dropbox/zugi/lemida/cbs_demographics.txt")
knesset_df <- read.csv("C:/Users/Shahar/Dropbox/zugi/lemida/knesset_24.csv", encoding = "UTF-8")
#social economic data frame of 2013 from the ISB
T1 <- read_excel("C:/Users/Shahar/Dropbox/zugi/lemida/bycode2013.xls")
#clean the names of the village in both data frames for maximal result of matches when we merged the data frames.
T1$village <- str_replace_all(T1$village, "[[:punct:]]", "")
CBS_df$village <- str_replace_all(CBS_df$village, "[[:punct:]]", "")
T1$village <- str_replace_all(T1$village, " ", "")
CBS_df$village <- str_replace_all(CBS_df$village, " ", "")
#add the location name to the CBS data frame
CBS_df1 <- merge(CBS_df,T1)
knesset_df1 <- merge(knesset_df, T1)
#merged the datas.
merged_df <- merge(CBS_df1,knesset_df)
rownames(merged_df) <- merged_df$village
#semple 20 locations
Semp_20 <- sample(merged_df$"סמל.ישוב" , 20)
# sum all the votes for each location
#calculate the persents of votes for each party in every location
knesset_df_norm <- knesset_df1 %>%rowwise %>% mutate(total_votes = sum(c_across( 8:46))) %>% ungroup() %>%  mutate(round(across(8:46, ~ . / total_votes),3))
#filter each data frame for the sempled values.
knesset_semp20 <- filter(knesset_df_norm, knesset_df_norm$"סמל.ישוב" %in% Semp_20)
CBS_semp20 <- filter(CBS_df1, CBS_df1$"סמל.ישוב" %in% Semp_20)
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 6, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
#g1
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
#g1
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
g1
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
#g2
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE)
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) ,
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6))
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g2
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)
g2
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE) + xlab("")
g2
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE) + xlab("") + ylab("")
g2
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal(),
horiz = TRUE)  + xlab("") + ylab("")
g1
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE) + xlab("") + ylab("")
g2
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
theme = theme_minimal())
g1
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g2
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g1
tanglegram(dend1, dend)
clus1 <- hclust(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
hc1 <- hclust(votes_dist, method = "complete")
hc2 <- hclust(living_stand_dist, method = "ward.D2")
# Create two dendrograms
dend1 <- as.dendrogram (hc1)
dend2 <- as.dendrogram (hc2)
tanglegram(dend1, dend2)
hc1 <- hclust(votes_dist, method = "single")
hc2 <- hclust(living_stand_dist, method = "single")
# Create two dendrograms
dend1 <- as.dendrogram (hc1)
dend2 <- as.dendrogram (hc2)
tanglegram(dend1, dend2)
votes_dist
View(CBS_semp20)
labels(hc1) <- knesset_semp20$`שם יישוב`
labels(hc2) <- CBS_semp20$`שם יישוב`
# Create two dendrograms
dend1 <- as.dendrogram (hc1)
dend2 <- as.dendrogram (hc2)
tanglegram(dend1, dend2)
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'ward.D2')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g2
votes_dist <-  knesset_semp20[,c(8:46)] %>% dist
clus <- hcut(votes_dist, k = 4, hc_func = 'hclust',
hc_method = 'single', graph = FALSE, isdiss = TRUE)
dend <- as.dendrogram(clus)
labels(dend) <- knesset_semp20$"שם.ישוב"
dend <- sort(dend, decreasing = FALSE)
g1 <- ggplot(dend %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g1
living_stand_dist <- CBS_semp20[which(colnames(CBS_semp20) %in% c('income', 'motorization','avgvehicle','avgabroad'))] %>% scale %>% dist
clus1 <- hcut(living_stand_dist, k = 4, hc_func = 'hclust',
hc_method = 'single')
dend1 <- as.dendrogram(clus1)
labels(dend1) <- knesset_semp20$"שם.ישוב"
dend1 <- sort(dend1, decreasing = FALSE)
g2 <- ggplot(dend1 %>% set('branches_k_color', k = 4) %>%
set('branches_lwd', 0.6) %>%
set('labels_colors', k = 4) %>%
set('labels_cex', 0.6),
horiz = TRUE)
g2
hc1 <- hclust(votes_dist, method = "single")
hc2 <- hclust(living_stand_dist, method = "single")
labels(hc1) <- knesset_semp20$`שם יישוב`
labels(hc2) <- CBS_semp20$`שם יישוב`
# Create two dendrograms
dend1 <- as.dendrogram (hc1)
dend2 <- as.dendrogram (hc2)
tanglegram(dend1, dend2)
